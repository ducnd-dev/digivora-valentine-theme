{% comment %}
  POD Review Summary
  Displays star rating and review count
  
  Usage: {% render 'review-summary-pod', rating: 4.8, count: 247 %}
{% endcomment %}

{%- liquid
  assign rating = rating | default: 4.8
  assign count = count | default: 247
  assign full_stars = rating | floor
  assign has_half_star = false
  assign decimal = rating | modulo: 1
  if decimal >= 0.25 and decimal < 0.75
    assign has_half_star = true
  elsif decimal >= 0.75
    assign full_stars = full_stars | plus: 1
  endif
-%}

<div class="product__review-summary">
  <div class="review-stars" aria-label="{{ rating }} out of 5 stars">
    {%- for i in (1..full_stars) -%}
      <svg class="icon icon-star" width="18" height="18" viewBox="0 0 18 18" fill="none">
        <path d="M9 1L11.472 6.26604L17.5595 7.11567L13.2798 11.234L14.416 17.3843L9 14.56L3.584 17.3843L4.72024 11.234L0.440492 7.11567L6.528 6.26604L9 1Z" fill="currentColor"/>
      </svg>
    {%- endfor -%}
    {%- if has_half_star -%}
      <svg class="icon icon-star" width="18" height="18" viewBox="0 0 18 18" fill="none">
        <defs>
          <linearGradient id="half-star">
            <stop offset="50%" stop-color="currentColor"/>
            <stop offset="50%" stop-color="rgba(var(--color-foreground), 0.2)"/>
          </linearGradient>
        </defs>
        <path d="M9 1L11.472 6.26604L17.5595 7.11567L13.2798 11.234L14.416 17.3843L9 14.56L3.584 17.3843L4.72024 11.234L0.440492 7.11567L6.528 6.26604L9 1Z" fill="url(#half-star)"/>
      </svg>
    {%- endif -%}
    {%- assign empty_stars = 5 | minus: full_stars -%}
    {%- if has_half_star -%}
      {%- assign empty_stars = empty_stars | minus: 1 -%}
    {%- endif -%}
    {%- for i in (1..empty_stars) -%}
      <svg class="icon icon-star icon-star--empty" width="18" height="18" viewBox="0 0 18 18" fill="none">
        <path d="M9 1L11.472 6.26604L17.5595 7.11567L13.2798 11.234L14.416 17.3843L9 14.56L3.584 17.3843L4.72024 11.234L0.440492 7.11567L6.528 6.26604L9 1Z" fill="rgba(var(--color-foreground), 0.2)"/>
      </svg>
    {%- endfor -%}
  </div>
  <span class="review-rating">{{ rating }}</span>
  <a href="#product-reviews" class="review-count">({{ count }} reviews)</a>
  <span class="review-verified">âœ“ Verified Reviews</span>
</div>
